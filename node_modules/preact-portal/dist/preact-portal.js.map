{"version":3,"file":null,"sources":["../src/preact-portal.js"],"sourcesContent":["import { h, Component, render } from 'preact';\n\n/** Redirect rendering of descendants into the given CSS selector.\n *  @example\n *    <Portal into=\"body\">\n *      <div>I am rendered into document.body</div>\n *    </Portal>\n */\nexport default class Portal extends Component {\n\tcomponentDidUpdate(props) {\n\t\tfor (let i in props) {\n\t\t\tif (props[i]!==this.props[i]) {\n\t\t\t\treturn this.renderLayer();\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.renderLayer();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.renderLayer(false);\n\t\tif (this.remote) this.remote.parentNode.removeChild(this.remote);\n\t}\n\n\tfindNode(node) {\n\t\treturn typeof node==='string' ? document.querySelector(node) : node;\n\t}\n\n\trenderLayer(show=true) {\n\t\t// clean up old node if moving bases:\n\t\tif (this.props.into!==this.intoPointer) {\n\t\t\tthis.intoPointer = this.props.into;\n\t\t\tif (this.into && this.remote) {\n\t\t\t\tthis.remote = render(<PortalProxy />, this.into, this.remote);\n\t\t\t}\n\t\t\tthis.into = this.findNode(this.props.into);\n\t\t}\n\n\t\tthis.remote = render((\n\t\t\t<PortalProxy context={this.context}>\n\t\t\t\t{ show && this.props.children || null }\n\t\t\t</PortalProxy>\n\t\t), this.into, this.remote);\n\t}\n\n\trender() {\n\t\treturn null;\n\t}\n}\n\n\n// high-order component that renders its first child if it exists.\n// used as a conditional rendering proxy.\nclass PortalProxy extends Component {\n\tgetChildContext() {\n\t\treturn this.props.context;\n\t}\n\trender({ children }) {\n\t\treturn children && children[0] || null;\n\t}\n}\n"],"names":["Portal","componentDidUpdate","props","i","renderLayer","componentDidMount","componentWillUnmount","remote","parentNode","removeChild","findNode","node","document","querySelector","show","into","intoPointer","render","h","context","children","Component","PortalProxy","getChildContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAQqBA;;;;;;;;kBACpBC,iDAAmBC,OAAO;OACpB,IAAIC,CAAT,IAAcD,KAAd,EAAqB;OAChBA,MAAMC,CAAN,MAAW,KAAKD,KAAL,CAAWC,CAAX,CAAf,EAA8B;WACtB,KAAKC,WAAL,EAAP;;;;;kBAKHC,iDAAoB;OACdD,WAAL;;;kBAGDE,uDAAuB;OACjBF,WAAL,CAAiB,KAAjB;MACI,KAAKG,MAAT,EAAiB,KAAKA,MAAL,CAAYC,UAAZ,CAAuBC,WAAvB,CAAmC,KAAKF,MAAxC;;;kBAGlBG,6BAASC,MAAM;SACP,OAAOA,IAAP,KAAc,QAAd,GAAyBC,SAASC,aAAT,CAAuBF,IAAvB,CAAzB,GAAwDA,IAA/D;;;kBAGDP,qCAAuB;MAAXU,IAAW,yDAAN,IAAM;;MAElB,KAAKZ,KAAL,CAAWa,IAAX,KAAkB,KAAKC,WAA3B,EAAwC;QAClCA,WAAL,GAAmB,KAAKd,KAAL,CAAWa,IAA9B;OACI,KAAKA,IAAL,IAAa,KAAKR,MAAtB,EAA8B;SACxBA,MAAL,GAAcU,cAAOC,SAAC,WAAD,OAAP,EAAwB,KAAKH,IAA7B,EAAmC,KAAKR,MAAxC,CAAd;;QAEIQ,IAAL,GAAY,KAAKL,QAAL,CAAc,KAAKR,KAAL,CAAWa,IAAzB,CAAZ;;;OAGIR,MAAL,GAAcU,cACbC;cAAA;KAAa,SAAS,KAAKC,OAA3B;WACW,KAAKjB,KAAL,CAAWkB,QAAnB,IAA+B;GAFrB,EAIX,KAAKL,IAJM,EAIA,KAAKR,MAJL,CAAd;;;kBAODU,2BAAS;SACD,IAAP;;;;EAxCkCI;;IA+C9BC;;;;;;;;uBACLC,6CAAkB;SACV,KAAKrB,KAAL,CAAWiB,OAAlB;;;uBAEDF,+BAAqB;MAAZG,QAAY,QAAZA,QAAY;;SACbA,YAAYA,SAAS,CAAT,CAAZ,IAA2B,IAAlC;;;;EALwBC;;;;"}